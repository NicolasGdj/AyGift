<div v-else class="container">
  <div class="header">
    <h1>AyGift</h1>
    <p v-if="isAdmin">
      Mode Admin
      <button type="button" class="logout-btn" @click="logout">D√©connexion</button>
    </p>
    <p v-else>Bonjour {{ userName }} !</p>
  </div>
  <div class="search-container">
    <span class="search-icon">üîç</span>
    <input type="text" class="search-input" v-model="searchQuery" placeholder="Rechercher un article ou une cat√©gorie..." />
  </div>
  <button type="button" class="filter-toggle-btn" @click="togglePriceFilter">
    <span>Filtrer par prix</span>
    <span>{{ showPriceFilter ? '‚ñ≤' : '‚ñº' }}</span>
  </button>
  <div class="price-filter" :class="{ collapsed: !showPriceFilter }">
    <h4>Filtrer par prix</h4>
    <div class="price-inputs">
      <input type="number" v-model.number="priceMin" placeholder="Min (‚Ç¨)" min="0" />
      <span>-</span>
      <input type="number" v-model.number="priceMax" placeholder="Max (‚Ç¨)" min="0" />
    </div>
  </div>
  <div v-if="isAdmin" class="admin-toolbar">
    <button type="button" class="btn btn-success btn-small" @click="showCategoryForm = true">+ Nouvelle Cat√©gorie</button>
    <button type="button" class="btn btn-primary btn-small" @click="addNewItem">+ Nouvel Article</button>
    <button type="button" class="btn btn-info btn-small" @click="openBulkImport">+ Bulk</button>
    <button type="button" class="btn btn-danger btn-small" @click="resetAllBookings">R√©initialiser Int√©r√™ts</button>
  </div>
  <div class="category-menu">
    <div class="category-item">
      <button type="button" class="category-btn" :class="{ active: selectedCategory === null }" @click="selectCategory(null)">Toutes</button>
    </div>
    <div class="category-item" v-for="cat in categories" :key="cat.id">
      <button type="button" class="category-btn" :class="{ active: selectedCategory === cat.id }">
        <span @click="handleCategoryClick(cat)">{{ cat.name }}</span>
        <span v-if="isAdmin" class="category-actions-trigger" @click.stop="toggleCategoryMenu(cat, $event)">‚öôÔ∏è</span>
      </button>
      <div v-if="isAdmin && openCategoryMenuId === cat.id" class="category-actions-menu">
        <button type="button" @click="addItemInCategory(cat)">+ Article</button>
        <button type="button" @click="deleteCategory(cat)" class="danger">Supprimer</button>
      </div>
    </div>
  </div>
  <div v-if="loading" class="loading">Chargement...</div>
  <div v-else>
    <div v-if="wishlistItems.length > 0" class="carousel-section">
      <h2 class="carousel-title">Ce que j'aimerais</h2>
      <div class="carousel-container">
        <div class="carousel">
          <div v-for="(item, index) in wishlistItems" :key="item.id" class="item-card" :class="{ active: item === currentWishlistItem }" @click="showItemDetail(item)">
            <div class="item-card-top">
              <img v-if="item.image" :src="item.image" :alt="item.name" class="item-image" />
              <div class="item-content">
                <div class="item-header">
                  <h3 :title="item.name">{{ item.name }}</h3>
                  <div class="item-price-badge" v-if="item.price">{{ item.price }}‚Ç¨</div>
                </div>
                <div class="item-date" v-if="item.last_interest_date">Nicolas a renouvel√© son int√©r√™t le <br>{{ formatDate(item.last_interest_date) }}</div>
              </div>
            </div>
            <div class="item-card-bottom" v-if="!isAdmin">
              <button type="button" tabindex="-1" class="interest-button" :class="{ interested: isUserInterested(item) }" @click.prevent.stop="toggleInterest(item)" @touchstart.stop @touchend.stop>
                {{ isUserInterested(item) ? '‚úì Int√©ress√©' : '√áa m\'int√©resse' }}
                <span class="interest-count">({{ getInterestCount(item) }})</span>
              </button>
            </div>
          </div>
          <div class="item-card load-more-card" @click="loadMoreWishlist()">
            <div class="item-content">
              <h3>Charger plus</h3>
              <div v-if="loadingMore" class="loading-spinner"></div>
            </div>
          </div>
        </div>
        <button type="button" v-if="wishlistItems.length > 5" class="nav-arrow left" @click="scrollWishlist(-1)" aria-label="Pr√©c√©dent">‚Äπ</button>
        <button type="button" v-if="wishlistItems.length > 5" class="nav-arrow right" @click="scrollWishlist(1)" aria-label="Suivant">‚Ä∫</button>
      </div>
    </div>
    <div v-if="ownedItems.length > 0" class="carousel-section">
      <h2 class="carousel-title">Ce que j'ai d√©j√†</h2>
      <div class="carousel-container">
        <div class="carousel">
          <div v-for="(item, index) in ownedItems" :key="item.id" class="item-card owned" :class="{ active: item === currentOwnedItem }" @click="showItemDetail(item)">
            <div class="item-card-top">
              <img v-if="item.image" :src="item.image" :alt="item.name" class="item-image" />
              <div class="item-content">
                <div class="item-header">
                  <h3 :title="item.name">{{ item.name }}</h3>
                  <div class="item-price-badge" v-if="item.price">{{ item.price }}‚Ç¨</div>
                </div>
              </div>
            </div>
          </div>
          <div class="item-card load-more-card" @click="loadMoreOwned()">
            <div class="item-content">
              <h3>Charger plus</h3>
              <div v-if="loadingMore" class="loading-spinner"></div>
            </div>
          </div>
        </div>
        <button type="button" v-if="ownedItems.length > 5" class="nav-arrow left" @click="scrollOwned(-1)" aria-label="Pr√©c√©dent">‚Äπ</button>
        <button type="button" v-if="ownedItems.length > 5" class="nav-arrow right" @click="scrollOwned(1)" aria-label="Suivant">‚Ä∫</button>
      </div>
    </div>
  </div>
</div>
